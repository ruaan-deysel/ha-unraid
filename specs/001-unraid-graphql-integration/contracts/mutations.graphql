# Unraid GraphQL API Mutations
# Feature: 001-unraid-graphql-integration
# Date: 2025-12-23
# Source: Official Unraid API Schema v4.29.2

# ============================================================================
# DOCKER CONTAINER CONTROL
# ============================================================================

# Mutation: Start Container
# Purpose: Start a stopped Docker container
# Used by: Docker switch turn_on
# Returns: DockerContainer with updated state
mutation StartContainer($id: PrefixedID!) {
  docker {
    start(id: $id) {
      id
      state
      status
    }
  }
}

# Mutation: Stop Container
# Purpose: Stop a running Docker container
# Used by: Docker switch turn_off
# Returns: DockerContainer with updated state
mutation StopContainer($id: PrefixedID!) {
  docker {
    stop(id: $id) {
      id
      state
      status
    }
  }
}

# Mutation: Pause Container
# Purpose: Pause (suspend) a running Docker container
# Used by: Docker pause action (optional)
# Returns: DockerContainer with updated state
mutation PauseContainer($id: PrefixedID!) {
  docker {
    pause(id: $id) {
      id
      state
      status
    }
  }
}

# Mutation: Unpause Container
# Purpose: Resume a paused Docker container
# Used by: Docker unpause action (optional)
# Returns: DockerContainer with updated state
mutation UnpauseContainer($id: PrefixedID!) {
  docker {
    unpause(id: $id) {
      id
      state
      status
    }
  }
}

# Mutation: Update Container
# Purpose: Update a container to the latest image
# Used by: Container update service (optional)
# Returns: DockerContainer with update status
mutation UpdateContainer($id: PrefixedID!) {
  docker {
    updateContainer(id: $id) {
      id
      state
      isUpdateAvailable
    }
  }
}

# Mutation: Remove Container
# Purpose: Remove a Docker container
# Used by: Container removal (optional, use with caution)
# Parameters: withImage - also remove the image
# Returns: Boolean success
mutation RemoveContainer($id: PrefixedID!, $withImage: Boolean) {
  docker {
    removeContainer(id: $id, withImage: $withImage)
  }
}

# ============================================================================
# VIRTUAL MACHINE CONTROL
# ============================================================================

# Mutation: Start VM
# Purpose: Start a stopped virtual machine
# Used by: VM switch turn_on
# Returns: Boolean success
mutation StartVM($id: PrefixedID!) {
  vm {
    start(id: $id)
  }
}

# Mutation: Stop VM
# Purpose: Stop a running virtual machine (graceful shutdown)
# Used by: VM switch turn_off
# Returns: Boolean success
mutation StopVM($id: PrefixedID!) {
  vm {
    stop(id: $id)
  }
}

# Mutation: Force Stop VM
# Purpose: Force stop a virtual machine (hard power off)
# Used by: VM force stop action (optional)
# Returns: Boolean success
mutation ForceStopVM($id: PrefixedID!) {
  vm {
    forceStop(id: $id)
  }
}

# Mutation: Pause VM
# Purpose: Pause (suspend) a virtual machine
# Used by: VM pause action (optional)
# Returns: Boolean success
mutation PauseVM($id: PrefixedID!) {
  vm {
    pause(id: $id)
  }
}

# Mutation: Resume VM
# Purpose: Resume a paused virtual machine
# Used by: VM resume action (optional)
# Returns: Boolean success
mutation ResumeVM($id: PrefixedID!) {
  vm {
    resume(id: $id)
  }
}

# Mutation: Reboot VM
# Purpose: Reboot a virtual machine
# Used by: VM reboot action (optional)
# Returns: Boolean success
mutation RebootVM($id: PrefixedID!) {
  vm {
    reboot(id: $id)
  }
}

# Mutation: Reset VM
# Purpose: Reset a virtual machine (hard reboot)
# Used by: VM reset action (optional)
# Returns: Boolean success
mutation ResetVM($id: PrefixedID!) {
  vm {
    reset(id: $id)
  }
}

# ============================================================================
# ARRAY CONTROL (Optional - Use with Caution)
# ============================================================================

# Mutation: Start Array
# Purpose: Start the disk array
# Used by: Array control (optional, requires confirmation)
# Returns: UnraidArray with updated state
mutation StartArray {
  array {
    setState(input: { desiredState: START }) {
      id
      state
    }
  }
}

# Mutation: Stop Array
# Purpose: Stop the disk array
# Used by: Array control (optional, requires confirmation)
# Returns: UnraidArray with updated state
mutation StopArray {
  array {
    setState(input: { desiredState: STOP }) {
      id
      state
    }
  }
}

# ============================================================================
# PARITY CHECK CONTROL (Optional)
# ============================================================================

# Mutation: Start Parity Check
# Purpose: Start a parity check
# Parameters: correct - whether to write corrections to parity
# Used by: Parity check service (optional)
# Returns: JSON result
mutation StartParityCheck($correct: Boolean!) {
  parityCheck {
    start(correct: $correct)
  }
}

# Mutation: Pause Parity Check
# Purpose: Pause a running parity check
# Used by: Parity check control (optional)
# Returns: JSON result
mutation PauseParityCheck {
  parityCheck {
    pause
  }
}

# Mutation: Resume Parity Check
# Purpose: Resume a paused parity check
# Used by: Parity check control (optional)
# Returns: JSON result
mutation ResumeParityCheck {
  parityCheck {
    resume
  }
}

# Mutation: Cancel Parity Check
# Purpose: Cancel a running parity check
# Used by: Parity check control (optional)
# Returns: JSON result
mutation CancelParityCheck {
  parityCheck {
    cancel
  }
}

# ============================================================================
# NOTIFICATION MANAGEMENT (Optional)
# ============================================================================

# Mutation: Archive Notification
# Purpose: Mark a notification as archived (read)
# Used by: Notification management (optional)
# Returns: Updated Notification
mutation ArchiveNotification($id: PrefixedID!) {
  archiveNotification(id: $id) {
    id
    type
  }
}

# Mutation: Archive All Notifications
# Purpose: Archive all notifications (optionally by importance)
# Used by: Notification management (optional)
# Returns: Updated NotificationOverview
mutation ArchiveAllNotifications($importance: NotificationImportance) {
  archiveAll(importance: $importance) {
    unread {
      total
    }
    archive {
      total
    }
  }
}

# Mutation: Unread Notification
# Purpose: Mark an archived notification as unread
# Used by: Notification management (optional)
# Returns: Updated Notification
mutation UnreadNotification($id: PrefixedID!) {
  unreadNotification(id: $id) {
    id
    type
  }
}

# ============================================================================
# DISK MANAGEMENT (Optional - Use with Extreme Caution)
# ============================================================================

# Note: These mutations can cause data loss if used incorrectly.
# They are documented here for completeness but should NOT be
# exposed in the Home Assistant integration without explicit
# user confirmation and warnings.

# Mutation: Spin Down Array Disk
# Purpose: Spin down a specific disk
# Used by: Disk management (not recommended for HA)
# mutation SpinDownDisk($id: PrefixedID!) {
#   array {
#     unmountArrayDisk(id: $id) {
#       id
#       isSpinning
#     }
#   }
# }

# Mutation: Spin Up Array Disk
# Purpose: Spin up a specific disk
# Used by: Disk management (not recommended for HA)
# mutation SpinUpDisk($id: PrefixedID!) {
#   array {
#     mountArrayDisk(id: $id) {
#       id
#       isSpinning
#     }
#   }
# }
